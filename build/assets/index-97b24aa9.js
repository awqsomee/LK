var L=Object.defineProperty,G=Object.defineProperties;var V=Object.getOwnPropertyDescriptors;var _=Object.getOwnPropertySymbols;var Y=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var q=(t,e,o)=>e in t?L(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o,v=(t,e)=>{for(var o in e||(e={}))Y.call(e,o)&&q(t,o,e[o]);if(_)for(var o of _(e))J.call(e,o)&&q(t,o,e[o]);return t},x=(t,e)=>G(t,V(e));var $=(t,e,o)=>new Promise((l,n)=>{var i=s=>{try{a(o.next(s))}catch(c){n(c)}},u=s=>{try{a(o.throw(s))}catch(c){n(c)}},a=s=>s.done?l(s.value):Promise.resolve(s.value).then(i,u);a((o=o.apply(t,e)).next())});import{p as K,e as I,bG as Q,h as X,l as j,q as D,j as r,s as Z,r as p,F as ee,az as te}from"./vendor-8a1e4858.js";import{at as O,au as U,q as oe,dM as P,dN as W,cY as ie,p as ae,s as le,a5 as C,cm as re,W as se,t as ne,bB as de,g as ue,dO as ce,dP as pe,i as me,bC as ve}from"./index-c5284d06.js";import{r as w}from"./index-531e7380.js";const fe=()=>O.get(`?getRequestHighComfort&token=${U()}`),he=t=>{const e=new FormData;e.set("token",U()),e.set("postRequestHighComfort","1");for(const[o,l]of Object.entries(t))e.set(o,l);return O.post("?postRequestHighComfort=1",e,{headers:{"Content-Type":"multipart/form-data"}})},M={superiorRoom:null,error:null},xe=()=>({data:j(A).superiorRoom,loading:j(g.pending),error:j(A).error}),ge=K({name:"postSuperiorRoom",sid:"8fhu4k"}),be=I(t=>$(void 0,null,function*(){}),{name:"postSuperiorRoomFx",sid:"-fra7ot"});Q({from:ge,to:be});const g=I(()=>$(void 0,null,function*(){try{return(yield fe()).data}catch(t){throw new Error("Не удалось загрузить раздел")}}),{name:"getSuperiorRoomFx",sid:"drkyz"}),A=X(M,{name:"$superiorRoomStore",sid:"-qtf9jq"}).on(g,t=>x(v({},t),{error:null})).on(g.doneData,(t,e)=>x(v({},t),{superiorRoom:e})).on(g.failData,(t,e)=>x(v({},t),{error:e.message})).on(oe.userGuid,()=>v({},M)),ke={useSuperiorRoom:xe},Fe={getSuperiorRoomFx:g},ye=t=>{const e=t.find(l=>l.fieldName==="address");let o=null;return e!=null&&e.value&&(e==null?void 0:e.value).id!=="pk"&&(o="not_dorm11"),{reason_academic:o}},B=`Подача заявок открыта с ${D(new Date(P),"HH:mm d MMMM",{locale:w})} до ${D(new Date(W),"HH:mm d MMMM",{locale:w})}!`,Re=t=>{const e=new Date;return e<new Date(P)?B:e>new Date(W)?"Подача заявок закрыта":""},T=[{id:0,title:"Один в комнате"},{id:1,title:"Двое в комнате"}],E=[{id:1,title:"Двое в комнате"},{id:2,title:"Трое в комнате"}],z=[{id:0,title:"Один в комнате"},{id:1,title:"Двое в комнате"},{id:2,title:"Трое в комнате"},{id:3,title:"Семейная комната"}],H=[{id:2,title:"Трое в комнате"}],Se=[{id:"ms",title:"Общежитие № 1, г. Москва, ул. Малая Семеновская, д. 12"},{id:"m",title:"Общежитие № 5, г. Москва, ул. Михалковская, д. 7, к. 3"},{id:"bg",title:"Общежитие № 6, г. Москва, ул. Бориса Галушкина, д. 9"},{id:"pk",title:"Общежитие № 11, г. Москва, ул. Павла Корчагина, д. 22А, к. 2"}],$e=[{value:!1,title:"Общественная",files:[],maxFiles:10,required:!0,fieldName:"society",checkboxCondition:"straight"},{value:!1,title:"Научная",files:[],maxFiles:10,required:!0,fieldName:"science",checkboxCondition:"straight"},{value:!1,title:"Спортивная",files:[],maxFiles:10,required:!0,fieldName:"sport",checkboxCondition:"straight"},{value:!1,title:"Творческая",files:[],maxFiles:10,required:!0,fieldName:"creativity",checkboxCondition:"straight"}],je=(t,e)=>{var o,l,n,i,u,a,s,c,f;const{fio:b,phone:k,email:F}=t,d=e==null||(o=e.data[3])===null||o===void 0||(o=o.value)===null||o===void 0?void 0:o.id,y=e==null||(l=e.data[7])===null||l===void 0?void 0:l.value,R=e==null||(n=e.optionalCheckbox)===null||n===void 0?void 0:n.value;return{title:"Заявка на комнату повышенной комфортности",data:[{title:"ФИО",value:b,fieldName:"fio",width:"100%",editable:!1},{title:"Телефон",value:(i=e==null||(u=e.data[1])===null||u===void 0?void 0:u.value)!==null&&i!==void 0?i:k,fieldName:"phone",type:"tel",width:"100%",editable:!0,required:!0,mask:!0},{title:"Email",value:(a=e==null||(s=e.data[2])===null||s===void 0?void 0:s.value)!==null&&a!==void 0?a:F,fieldName:"email",type:"email",width:"100%",editable:!0,required:!0},{title:"Адрес общежития",value:(c=e==null||(f=e.data[3])===null||f===void 0?void 0:f.value)!==null&&c!==void 0?c:null,fieldName:"address",type:"select",items:Se,width:"100%",editable:!0,required:!0},{title:"Приоритетный тип размещения",value:null,fieldName:"allocation",type:"select",items:d==="bg"?E:d==="pk"?H:d==="ms"?z:T,width:"100%",editable:!!d,required:!0},{title:"Альтернативный тип размещения",value:null,fieldName:"alternative-allocation",type:"select",items:d==="bg"?E:d==="pk"?H:d==="ms"?z:T,width:"100%",editable:!!d,required:!0,specialType:"not_dorm11"},{title:"Участие во внеучебной деятельности",value:null,fieldName:"extracurricular",type:"checkbox-docs",items:$e,width:"100%",editable:!0,required:!1},{title:"Необходимые документы приложены",type:"checkbox",value:!!y,fieldName:"",editable:!0,required:!0}],alert:r.jsx(r.Fragment,{children:B}),hint:"Перед отправкой заявки обязательно проверьте указанную в форме контактную информацию (мобильный телефон и адрес электронной почты) и при необходимости внесите изменения.",optionalCheckbox:{title:r.jsxs(r.Fragment,{children:["С"," ",r.jsx("a",{href:"https://mospolytech.ru/upload/medialibrary/dcd/aj5km0q67pkjw737j8g5hynmz2dfhlxb/Prikaz-_1564_OD-ot-28.12.2024-Ob-utverzhdenii-razmerov-platy-za-dopolnitelnuyu-uslugu.pdf",target:"_blank",rel:"noreferrer",children:"приказом"})," ","об утверждении размеров платы за дополнительную услугу в студенческом городке от 28.12.2024 N1564-ОД ознакомлен(а)"]}),value:!!R,fieldName:"",editable:!0}}},De=(t,e,o)=>{e(!0);const l=ie(t);try{he(l),e(!1),o(!0)}catch(n){e(!1),ae.evokePopUpMessage({message:`Не удалось отправить форму. Ошибка: ${n}`,type:"failure",time:3e4})}},we=Z.div.withConfig({componentId:"sc-15p7xv6-0"})(["display:flex;justify-content:center;width:100%;height:",";padding:10px;color:var(--text);@media (max-width:1000px){padding:0;}"],({isDone:t})=>t&&"100%"),Me=()=>{var t,e,o,l,n;const[i,u]=p.useState(null),{data:a,error:s}=ke.useSuperiorRoom(),[c,f]=p.useState(0),[b,k]=p.useState(!1),[F,d]=p.useState(!1),[y,R]=p.useState({}),h=(t=b||!(a!=null&&a.is_avaliable))!==null&&t!==void 0?t:!1,{data:{user:S}}=le.useUser();if((S==null?void 0:S.educationForm)!=="Очная")return r.jsx(C,{text:"Данный раздел недоступен для вашей формы обучения"});const N=Re();return re&&N?r.jsx(C,{text:N}):(p.useEffect(()=>{a&&u(je(a,i))},[a,c]),p.useEffect(()=>{if(i){var m;f(i==null||(m=i.data[3])===null||m===void 0||(m=m.value)===null||m===void 0?void 0:m.id)}},[i==null||(e=i.data[3])===null||e===void 0?void 0:e.value]),p.useEffect(()=>{i&&R(ye(i.data))},[i]),r.jsx(se,{load:()=>Fe.getSuperiorRoomFx(),loading:!a,error:s,data:a,children:r.jsx(we,{isDone:h,children:!!i&&!!u&&r.jsxs(ne,{children:[r.jsx(de,x(v({},i),{collapsed:h,setData:u,specialFieldsNameConfig:y})),r.jsx(ue,{title:"Информация по заявке",type:"info",icon:r.jsx(ee,{}),visible:h,children:r.jsxs("p",{children:["Ваша заявка направлена на рассмотрение жилищной комиссии. С результатами распределения мест и датой заселения можно будет ознакомиться"," ",D(new Date(ce),"d MMMM",{locale:w})," в Личном кабинете в разделе ",r.jsx(te,{to:pe,children:"«Список нуждающихся в общежитии»"}),"."]})}),r.jsx(me,{text:a!=null&&a.is_avaliable?"Отправить":"Отправлено",action:()=>De(i,d,k),isLoading:F,completed:b,setCompleted:k,repeatable:!1,buttonSuccessText:"Отправлено",isDone:h,isActive:ve(i)&&((o=(l=i.optionalCheckbox)===null||l===void 0?void 0:l.value)!==null&&o!==void 0?o:!0),popUpFailureMessage:h?(n=a==null?void 0:a.error_text)!==null&&n!==void 0?n:"Форма отправлена":"Для отправки формы необходимо, чтобы все поля были заполнены",popUpSuccessMessage:"Данные формы успешно отправлены"})]})})}))};export{Me as default};
